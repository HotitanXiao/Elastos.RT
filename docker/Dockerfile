FROM ubuntu:16.04

ARG HOST_USER_UID=1000
ARG HOST_USER_GID=1000

# Password of hostuser is 'mypassword'
# The encrypted password was generated by 'openssl passwd -1 mypassword'
ENV HOST_USER_PASSWD '$1$6wh4yp6s$ug4KmE998wKLYSgM7vH4z.'

ENV LANG=C.UTF-8

RUN set -ex                                                                         && \
                                                                                       \
    echo 'Creating non-root user and group from host'                               && \
    groupadd -f -g $HOST_USER_GID hostuser                                          && \
    useradd -lmo -p $HOST_USER_PASSWD -u $HOST_USER_UID -g $HOST_USER_GID hostuser  && \
    usermod -aG sudo hostuser                                                       && \
    echo 'docker' > /etc/debian_chroot                                              && \
    dpkg --add-architecture i386                                                    && \
    apt-get update && apt-get install -y                                               \
        sudo \
        vim-tiny \
        texinfo \
        libglib2.0-dev \
        autoconf \
        libtool \
        libsdl-dev \
        build-essential \
        tofrodos \
        bison \
        g++-multilib \
        git \
        gperf \
        libxml2-utils \
        make \
        bc \
        zip \
        zlib1g-dev \
        zlib1g-dev:i386 \
        libicu-dev \
        libicu-dev:i386 \
        libssl-dev \
        libssl-dev:i386 \
        gdbserver \
        bash-completion \
        cmake \
     && rm -rf /var/lib/apt/list/*                                                  && \
     echo 'hostuser        ALL=(ALL:ALL) NOPASSWD: ALL' > /etc/sudoers

USER hostuser

VOLUME /home/hostuser/Elastos.RT
WORKDIR /home/hostuser/Elastos.RT

